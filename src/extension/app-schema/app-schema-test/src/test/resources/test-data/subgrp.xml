<?xml version="1.0" encoding="UTF-8"?>
<as:AppSchemaDataAccess xmlns:as="http://www.geotools.org/app-schema"
    xmlns:ogc="http://www.opengis.net/ogc" xmlns:xs="http://www.w3.org/2001/XMLSchema"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.geotools.org/app-schema AppSchemaDataAccess.xsd
      http://www.opengis.net/ogc http://schemas.opengis.net/filter/1.1.0/expr.xsd">
    <namespaces>
        <Namespace>
            <prefix>test</prefix>
            <uri>http://www.geotools.org/test</uri>
        </Namespace>
        <Namespace>
            <prefix>gml</prefix>
            <uri>http://www.opengis.net/gml/3.2</uri>
        </Namespace>
        <Namespace>
            <prefix>xlink</prefix>
            <uri>http://www.w3.org/1999/xlink</uri>
        </Namespace>
    </namespaces>
    <sourceDataStores>
        <DataStore>
            <id>subgrp-coverage</id>
            <parameters>
                <Parameter>
                    <name>directory</name>
                    <value>file:./</value>
                </Parameter>
            </parameters>
        </DataStore>
    </sourceDataStores>
    <targetTypes>
        <FeatureType>
            <schemaUri>subgrp.xsd</schemaUri>
        </FeatureType>
    </targetTypes>
    <typeMappings>
        <FeatureTypeMapping>
            <!-- arbitrary mapping name -->
            <mappingName>subgrp-coverage</mappingName>
            <!-- datastore name from above-->
            <sourceDataStore>subgrp-coverage</sourceDataStore>
            <!-- source type must be a table or view from DataStore. For feature links, a sub-table. -->
            <sourceType>subgrp-coverage</sourceType>
            <!-- top level element this configuration maps to -->
            <targetElement>test:DiscreteCoverage</targetElement>
            <isDenormalized>false</isDenormalized>

            <!-- Feature link needs to be the foreign key that associates this data set with the parent -->
            <attributeMappings>
                <AttributeMapping>
                    <targetAttribute>test:DiscreteCoverage</targetAttribute>
                    <targetAttributeNode>test:DiscreteCoverageType</targetAttributeNode>
                    <idExpression>
                        <OCQL>uuid</OCQL>
                    </idExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>gml:identifier</targetAttribute>
                    <ClientProperty>
                        <name>codeSpace</name>
                        <value>'urn:ietf:rfc:1738'</value>
                    </ClientProperty>
                    <sourceExpression>
                        <OCQL>'http://www.geoserver.org/contour'</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>test:domainSet</targetAttribute>
                    <targetAttributeNode>test:DomainSetType</targetAttributeNode>
                    <encodeIfEmpty>true</encodeIfEmpty>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>test:domainSet/test:DomainObject</targetAttribute>
                    <targetAttributeNode>test:DomainObjectType</targetAttributeNode>
                    <encodeIfEmpty>true</encodeIfEmpty>
                    <idExpression>
                        <OCQL>strConcat(uuid,'-domainObjectId')</OCQL>
                    </idExpression>
                </AttributeMapping>

                <AttributeMapping>
                    <targetAttribute>test:domainSet/test:DomainObject/test:elements</targetAttribute>
                    <targetAttributeNode>test:SpatioTemporalElementsPropertyType</targetAttributeNode>
                    <encodeIfEmpty>true</encodeIfEmpty>
                </AttributeMapping>

                <AttributeMapping>
                    <targetAttribute>test:domainSet/test:DomainObject/test:elements/gml:MultiCurve</targetAttribute>
                    <encodeIfEmpty>true</encodeIfEmpty>
                    <idExpression>
                        <OCQL>strConcat(uuid,'-geomId')</OCQL>
                    </idExpression>
                    <sourceExpression>
                        <OCQL>geom</OCQL>
                    </sourceExpression>
                    <ClientProperty>
                        <name>srsName</name>
                        <value>'http://www.opengis.net/def/crs/EPSG/0/4052'</value>
                    </ClientProperty>
                    <ClientProperty>
                        <name>axisLabels</name>
                        <value>'latitude longitude'</value>
                    </ClientProperty>
                </AttributeMapping>

                <AttributeMapping>
                    <targetAttribute>test:domainSet/test:DomainObject/test:elements/gml:Point</targetAttribute>
                    <idExpression>
                        <OCQL>strConcat(uuid,'-geom2Id')</OCQL>
                    </idExpression>
                    <sourceExpression>
                        <OCQL>geom2</OCQL>
                    </sourceExpression>
                    <ClientProperty>
                        <name>srsName</name>
                        <value>'http://www.opengis.net/def/crs/EPSG/0/4052'</value>
                    </ClientProperty>
                    <ClientProperty>
                        <name>axisLabels</name>
                        <value>'latitude longitude'</value>
                    </ClientProperty>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>gml:rangeSet/gml:ValueArray</targetAttribute>
                    <idExpression>
                        <OCQL>strConcat(uuid,'-valueArrayId')</OCQL>
                    </idExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>gml:rangeSet/gml:ValueArray/gml:valueComponents/gml:Quantity</targetAttribute>
                    <ClientProperty>
                        <name>uom</name>
                        <value>amount_uom</value>
                    </ClientProperty>
                    <sourceExpression>
                        <OCQL>amount</OCQL>
                    </sourceExpression>
                </AttributeMapping>
                <AttributeMapping>
                    <targetAttribute>gml:coverageFunction/gml:CoverageMappingRule/gml:ruleDefinition</targetAttribute>
                    <sourceExpression>
                        <OCQL>rule</OCQL>
                    </sourceExpression>
                </AttributeMapping>
            </attributeMappings>
        </FeatureTypeMapping>
    </typeMappings>
</as:AppSchemaDataAccess>